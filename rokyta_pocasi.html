<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>Počasí</title>
</head>
<body>

<label>Město: <input id="mesto"></label>
<button onclick="zobrazPocasi()">Zobraz počasí</button>

<div id="pocasi"></div>

<script>
  const apiKey = 'd016e7c73065a42c5452794ee3b9967d';
  let interval;

  function zobrazPocasi() {
    clearInterval(interval);
    nactiPocasi();
    interval = setInterval(nactiPocasi, 60000); // aktualizace každou minutu
  }

  function nactiPocasi() {
    const mesto = document.getElementById("mesto").value.trim();
    const vystup = document.getElementById("pocasi");

    if (!mesto) {
      vystup.innerHTML = "Zadej město.";
      return;
    }

    const url = `https://api.openweathermap.org/data/2.5/weather?q=${mesto}&appid=${apiKey}&units=metric&lang=cz`;

    fetch(url)
      .then(response => {
        if (!response.ok) throw new Error("Chybná odpověď serveru");
        return response.json();
      })
      .then(data => {
        const nazev = data.name;
        const teplota = data.main.temp.toFixed(1);
        const popis = data.weather[0].description;
        const ikona = data.weather[0].icon;
        const obrazek = `https://openweathermap.org/img/wn/${ikona}@2x.png`;

        vystup.innerHTML = `
          <h3>${nazev}</h3>
          <p>Teplota: <b>${teplota} °C</b></p>
          <img src="${obrazek}" alt="Ikona počasí">
          <p>Počasícko: ${popis}</p>
        `;
      })
      .catch(() => {
        vystup.innerHTML = "chyba při načítání";
      });
  }
</script>

</body>
</html>
